<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8"/>
		<title>Alakzatszerkesztő (refaktorizált változat)</title>
		<link rel="stylesheet" href="assets/graphics.css"/>
		<link rel="stylesheet" href="../doc/doc.css"/>

		<script src="assets/entry-point/injectorMain.js"></script>
		<script src="assets/entry-point/App.js"></script>
		<script src="assets/controllers/State.js"></script>
		<script src="assets/entry-point/Router.js"></script>
		<script src="assets/entry-point/WidgetCollision.js"></script>

		<script src="assets/controllers/CompactModeController.js"></script>
		<script src="assets/controllers/NormalModeController.js"></script>
		<script src="assets/controllers/RoomController.js"></script>

		<script src="assets/physics/Figure.js"></script>
		<script src="assets/physics/Hypothetical.js"></script>
		<script src="assets/physics/AlgebraicCollision.js"></script>

		<script src="assets/textual-widgets/RoomStampUI.js"></script>
		<script src="assets/textual-widgets/ModeUI.js"></script>
		<script src="assets/textual-widgets/OperationUI.js"></script>
		<script src="assets/textual-widgets/KeyboardUI.js"></script>

		<script src="assets/widget-pillar/WidgetFactory.js"></script>
		<script src="assets/widget-pillar/WidgetEventPillar.js"></script>
		<script src="assets/widget-pillar/Widget.js"></script>
		<script src="assets/widget-pillar/CoordSysTransformer.js"></script>
		<script src="assets/widget-pillar/Bijection.js"></script>

		<script src="assets/domain/DomainObject.js"></script>
		<script src="assets/domain/RoomFactory.js"></script>
		<script src="assets/domain/Room.js"></script>
		<script src="assets/domain/MassPoint1Factory.js"></script>
		<script src="assets/domain/MassPoint1.js"></script>
		<script src="assets/domain/MassPoint2Factory.js"></script>
		<script src="assets/domain/MassPoint2.js"></script>

		<script src="assets/low-level-system/DOM-manipulation.js"></script>
		<script src="assets/low-level-system/SvgLowLevel.js"></script>
		<script src="assets/low-level-system/MyAudio.js"></script>

		<script src="assets/math/geometry.js"></script>
		<script src="assets/math/geometry-vector.js"></script>
		<script src="assets/math/geometry-polygon.js"></script>
		<script src="assets/math/linear-transformation.js"></script>
		<script src="assets/math/data-list.js"></script>
		<script src="assets/math/data-maybe.js"></script>
		<script src="assets/math/Eq.js"></script>
		<script src="assets/math/data-hash.js"></script>
		<script src="assets/math/graph.js"></script>
		<script src="assets/math/math.js"></script>
		<script src="assets/math/collision-common.js"></script>
		<script src="assets/math/fall-collision.js"></script>
		<script src="assets/math/contour-collision.js"></script>
		<script src="assets/math/haskell/app/collision-as-vector-transformation.js"></script>
		<script src="assets/math/collision-as-orthogonal-nearness.js"></script>

		<script src="assets/math/collision/equation-system-solver.js"></script>
		<script src="assets/math/collision/ray-intersection.js"></script>
		<script src="assets/math/collision/fall-orientation.js"></script>
		<script src="assets/math/collision/fall-vector.js"></script>
		<script src="assets/math/ccSubtree.js"></script>

		<script src="../spec/BehaviorRunner.js"></script>
		<script src="../spec/Mock.js"></script>
		<script src="../spec/SvgLowLevelMock.js"></script>
		<script src="../spec/CoordSysTransformerMock.js"></script>
		<script src="../spec/BijectionMock.js"></script>
		<script src="../spec/FigureMock.js"></script>
		<script src="../spec/Behavior.js"></script>
		<script src="../spec/AppBehavior.js"></script>
		<script src="../spec/FigureBehavior.js"></script>
		<script src="../spec/BijectionBehavior.js"></script>
		<script src="../spec/CollisionBehavior.js"></script>
		<script src="../spec/ContourCollisionBehavior.js"></script>
		<script src="assets/math/haskell/spec/CollisionAsVectorTransformationBehavior.js"></script>
		<script src="../spec/CollisionAsVectorFieldTransformationBehavior.js"></script>
		<script src="../spec/CollisionAsOrthogonalNearnessBehavior.js"></script>
		<script src="../spec/GeometryVectorBehavior.js"></script>
		<script src="../spec/CcSubtreeBehavior.js"></script>

		<script src="../spec/collision/EquationSystemSolverBehavior.js"></script>
		<script src="../spec/collision/RayIntersectionBehavior.js"></script>
		<script src="../spec/collision/FallOrientationBehavior.js"></script>
		<script src="../spec/collision/FallVectorBehavior.js"></script>


		<script src="assets/math/haskell/app/Board.js"></script>
		<script src="assets/math/haskell/app/FiguresBoard.js"></script>
		<script src="assets/math/haskell/app/Polygon.js"></script>
		<script src="assets/math/haskell/app/FourierMotzkinElimination.js"></script>
		<script src="assets/math/haskell/app/TourRotation.js"></script>
		<script src="assets/math/haskell/app/Orientation.js"></script>
		<script src="assets/math/haskell/app/Vector.js"></script>
		<script src="assets/math/haskell/app/LogicalForms.js"></script>
		<script src="assets/math/haskell/app/Logic.js"></script>
		<script src="assets/math/haskell/app/ListX.js"></script>
		<script src="assets/math/haskell/app/MaybeX.js"></script>
		<script src="assets/math/haskell/app/Either.js"></script>
		<script src="assets/math/haskell/app/TupleX.js"></script>
		<script src="assets/math/haskell/app/MonadX.js"></script>
		<script src="assets/math/haskell/app/NonEmptyFootList.js"></script>
		<script src="assets/math/haskell/app/Infinitesimal.js"></script>
		<script src="assets/math/haskell/app/LogicalForms.js"></script>
		<script src="assets/math/haskell/app/Combinator.js"></script>
		<script src="assets/math/haskell/app/Infinity.js"></script>
		<script src="assets/math/haskell/app/RealModulus.js"></script>
		<script src="assets/math/haskell/app/Sign.js"></script>
		<script src="assets/math/haskell/app/Polynomial.js"></script>

		<script src="assets/math/haskell/testRunner.js"></script>

		<script src="assets/math/haskell/spec/PolygonBehavior.js"></script>
		<script src="assets/math/haskell/spec/FourierMotzkinEliminationBehavior.js"></script>
		<script src="assets/math/haskell/spec/VectorBehavior.js"></script>
		<script src="assets/math/haskell/spec/LogicalFormsBehavior.js"></script>
		<script src="assets/math/haskell/spec/LogicBehavior.js"></script>
		<script src="assets/math/haskell/spec/NonEmptyFootListBehavior.js"></script>
		<script src="assets/math/haskell/spec/ListXBehavior.js"></script>
		<script src="assets/math/haskell/spec/MaybeXBehavior.js"></script>
		<script src="assets/math/haskell/spec/EitherBehavior.js"></script>
		<script src="assets/math/haskell/spec/MonadXBehavior.js"></script>
		<script src="assets/math/haskell/spec/InfinityBehavior.js"></script>
		<script src="assets/math/haskell/spec/SignBehavior.js"></script>
		<script src="assets/math/haskell/spec/BoardBehavior.js"></script>
		<script src="assets/math/haskell/spec/PolynomialBehavior.js"></script>
	</head>
	<body>
		<h1>Alakzatszerkesztő (refaktorizált változat)</h1>
		<p>
			Forráskódja <a href="https://github.com/alignalghii/loosely-coupled-figure-editor" target="_blank">íme itt: Alakzatszerkesztő</a>.
			Máshonnan felhasznált ötletek, köszönetnyilvánítások: <a href="../doc/credits.html">Credits</a>.
		</p>

		<h2>Használata</h2>
		<ul>
			<li><a href="../doc/normal-mode.html">Normál módban:</a> Ezt a módot vesszük alapul és egyelőre ez is az alapértelmezés. Ez a legjobban skálázható mód. Annyiból egyszerű, hogy az alakzatok egyszerűen a szokásos módon vonszolhatóak az egérrel. Azonban van egy sajátos ún. fókusz-fogalom is: ha vonszolás nélkül kattintunk rá az alakzatra (nem moccan meg az egér a lenyomás és a fölengedés közt), akkor a kattintott alakzat fókuszba kerül (ez szemmel is látszik kiemelve). A fókuszba került alakzat törölhető, ha a műveletlistban a &bdquo;Törlés&rdquo; szóra rákattintunk. Új alakzat beszúrásához pedig először rá kell kattintani egy üres helyre a vásznon. Ezt a helyet az alkalmazás megjegyzi (ez a helyfókusz, ami hasonló fogalom az alakzatok fókuszához, de azzal ellentétben a helyfókusz nem hagy látható nyomot a vásznon). Utána a &bdquo;Beszúrás&rdquo; szóra kattintva megtörténik az új alakzat beszúrása a helyfókusznak megfelelő helyre. Az, hogy milyen alakzat kerüljön beszúrásra, legördülő menüből választható ki.</li>
			<li><a href="../doc/compact-mode.html">Kompakt módban:</a> Elég az egér használata, szöveges műveletelemek nem szükségesek, mégis van beszúrás , törlés is a vonszoláson kívül. Fókuszfogalom nem létezik, ezért ez a mód nemigen skálázható összetettebb műveletekre. Alapvetően nem használjuk, teszt- és szemléltetési, megbeszélési célokból maradt fenn.</li>
			<li>Félkompakt módban: Alapvetően a normál módhoz hasonló, azon lapul, van fókuszfogalom. Viszont abban meg a kompakt módhoz hasonlít, hogy üres helyre kattintva új alakzat jelenik meg, az új alakzat automatikusan magára húzza a fókuszt.  Hasonlóképp, a vonszolás is magára húzza a fókuszt.</li>
			<li>Félfélkompakt módban: Alapvetően a normál módhoz hasonló, azon alapul, van fókuszfogalom. Viszont abban meg a kompakt módhoz hasonlít, hogy üres helyre kattintva új alakzat jelenik meg. De kevesebb a hasonlóság a kompakt móddal, mint a félkompakt mód esetében, mert itt a félfélkompakt módnál az új alakzat nem húzza magára húzza a fókuszt, vagyis ha van korábbi fókusz, az fókusz is marad. Hasonlóképp, a vonszolás sem húzza magára a fókuszt.</li>
			<li>Modularizált mód: a vonszolás nincs privilegizálva a többi  művelethez  képest. Vagy az is szöveges elemből kapcsolódik be, vagy pedig a többi műveletnél (pl. forgatás) is kihasználjuk a vonszolást mint megvalósító egérműveletet.</li>
		</ul>

		<h2>Kezelőparancs-felület</h2>
		<em>Módok:</em>
		<ul id="modes">
			<li><input id="modeNormal"  name="mode" value="normal"  type="radio"/> <label for="modeNormal" >Normál vonszolás és fókuszkezelés</label></li>
			<li><input id="modeCompact" name="mode" value="compact" type="radio"/> <label for="modeCompact">Kompakt mód (csak gyorstesztre, összevetésekre használt, &bdquo;mindentegybe&rdquo;-jellegű, elavult mód)</label></li>
		</ul>
		<label for="sampleRoomBank">A következő beszúrható szobasablon:</label>
		<select id="sampleRoomBank">
		</select>
		<div id="section-operations">
			<em>Műveletek (kattints a dobozkára, vagy alternatívaként nyomd meg a megadott billentyű-gyorsparancsot a billentyűzeten):</em>
			<ul id="operations">
				<li><button id="operationCreate">Új alakzat beszúrása</button> (vagy &bdquo;<span class="keystroke">+</span>&rdquo;-billentyű)</li>
				<li><button id="operationDelete">Fókuszált alakzat törlése</button> (vagy &bdquo;<span class="keystroke">-</span>&rdquo;, vagy &bdquo;<span class="keystroke">DEL</span>&rdquo;-billentyű)</li>
				<li><button id="operationUnfigfocus">Alakzatfókusz levétele</button> (vagy &bdquo;<span class="keystroke">ESC</span>&rdquo;-billentyű)</li>
				<li>Fókuszáltságtól függetlenül az alakzatok egérrel vonszolhatóak, ütközésvizsgálat ilyenkor automatikus. Fókuszált alakzat a &bdquo;<span class="keystroke">&larr;</span>&rdquo;, &bdquo;<span class="keystroke">&uarr;</span>&rdquo;, &bdquo;<span class="keystroke">&rarr;</span>&rdquo;, &bdquo;<span class="keystroke">&darr;</span>&rdquo; billentyűvel is mozgatható, az ütközésvizsgálat ilyenkor ki van kapcsolva (ez jól felhasználható &bdquo;beragadt&rdquo; alakzat &bdquo;kiszabadításához&rdquo;).</li>
				<li><span class="warning">To do: </span>Fókusz átugrása másik alakzatra: történetileg következőre &bdquo;<span class="keystroke">TAB</span>&rdquo;, történetileg előzőre &bdquo;<span class="keystroke">SHIFT</span>+<span class="keystroke">TAB</span>&rdquo;</li>
				<li>Fókuszba vett alakzat forgatása: tolóka, vagy óra járása szerint &bdquo;<span class="keystroke">)</span>&rdquo;, óra járásával ellentétes &bdquo;<span class="keystroke">(</span>&rdquo;. Ez a műveletpár nagyon lassú, csak finobeállításra jó. Gyorsváltozatuk: &bdquo;<span class="keystroke">}</span>&rdquo;, illetve &bdquo;<span class="keystroke">{</span>&rdquo;. Fontos, hogy a forgatás nemcsak magát az alakzatot forgatja el, hanem annak ún. &bdquo;referenciairányát&rdquo; is, ld. később.</li>
				<li>Tükrözés: <span class="warning">tolóka</span>, vagy függőleges tengely mentén &bdquo;<span class="keystroke">|</span>&rdquo;, vízszintes tengely mentén &bdquo;<span class="keystroke">=</span>&rdquo;. Fontos, hogy a &bdquo;vízszintes&rdquo; fogalma itt nem a rajzvászon, hanem az alakzat &bdquo;vízszintesét&rdquo; jelenti, amely csak az alakzat kirakásakor egyezik meg a rajzvászon vízszintesével. Egy leforgatott alakzat &bdquo;vízszintese&rdquo; is vele fordul. Ugyanez vonatkozik a &bdquo;függőleges&rdquo; fogalmára is. Mindez biztosítja, hogy pl. egy ferde, rézsútos elhelyezkedésű falra ráforgatott ajtóalakzat tükrözése az ajtó (és a fal) irányához viszonyítva történjék, ahogy természetes módon elvárjuk, nem pedig  rajzvászon &bdquo;abszolút&rdquo; &bdquo;égtájai&rdquo; szerint. Ez alapvetően egy természetes dolog, hiszen pl. a forgatás sem a vászon középpontja körül történik egységesen minden alakzatra, hanem minden alakzat a saját középpoontja körül fordul el, vagyis minden alakzatnak saját &bdquo;referenciapontja&rdquo; van. A tükrözés ehhez annyit teszhozzá, hogy az alakzatoknak nemcsak saját referenciapontjuk, hanem saját &bdquo;referenciairányuk&rdquo;, referenciaoientációjuk is van, és a tükrözés valójában ehhez mérten történik. Az alakzatok referenciairánya megszületésükkor egegyezik a rajzvászon szerinti &bdquo;abszolút&rdquo; vízszintessel, de az alakzat forgatásakor a referenciairányuk is velük fordul. Így a ferdén felrakott ajtók, ablakok türkrözése logikusan, saját magukhoz mérten tud történni.</li>
				<li>Nagyítás: <span class="warning">tolóka</span>, vagy &bdquo;<span class="keystroke">&gt;</span>&rdquo;, kicsinyítés &bdquo;<span class="keystroke">&lt;</span>&rdquo;. Nagyon lassúak, csak finombeállításra jók. Gyors változataik: &bdquo;<span class="keystroke">]</span>&rdquo; és &bdquo;<span class="keystroke">[</span>&rdquo;.</li>
				<li>Arányváltoztató átméretezés: <span class="warning">tolóka</span>, vagy függőleges kicsinyítés &bdquo;<span class="keystroke">.</span>&rdquo;, függőleges nagyítás &bdquo;<span class="keystroke">:</span>&rdquo;, vízszintes kicsinyítés &bdquo;<span class="keystroke">&apos;</span>&rdquo;, vízszintes nagyítás &bdquo;<span class="keystroke">&quot;</span>&rdquo;. Nagyon lassúak, csak finombeállításra jók. Gyors változataik: &bdquo;<span class="keystroke">L</span>&rdquo; és &bdquo;<span class="keystroke">Z</span>&rdquo;, illetve &bdquo;<span class="keystroke">I</span>&rdquo; és &bdquo;<span class="keystroke">H</span>&rdquo;. A nagybetűk helyett a nekik megfelelő kisbetűk is használhatóak. Az arányváltozató átméretezés függ az alakzat saját referenciairánytól (mit tekintünk &bdquo;vízszintesnek&rdquo;), erre is a korább leírtak vonatkoznak: az alakzat ismeri saját referenciairányát, és nemcsak a tükrözés, hanem az arányváltozató átméretezés is ez alapján történik.</li>
				<li>Területmegmaradás (scaleX és scaleY egyszerre úgy, hogy az egyik csökken, a másik nől, úgy hogy a terület ugyanannyi maradjon). <span class="warning">Tolóka</span>. Fűggőlegesen &bdquo;<span class="keystroke">$</span>&rdquo;, vízszintesen &bdquo;<span class="keystroke">~</span>&rdquo;. Nagyon lassúak, csak finombeállításra jók. Gyors változataik: függőlegesen nyújt ki &bdquo;<span class="keystroke">§</span>&rdquo; vagy &bdquo;<span class="keystroke">S</span>&rdquo;, és vízszintesen nyújt ki &bdquo;<span class="keystroke">÷</span>&rdquo; vagy &bdquo;<span class="keystroke">W</span>&rdquo; (a betűjeleknél használhatók a kisbetűs megfelelőik is). A területmegtartó átméretezés is függ az alakzat saját referenciairányától (mit tekintünk &bdquo;vízszintesnek&rdquo;), erre is a korább leírtak vonatkoznak.</li>
				<li><span class="warning">To do: </span> Falnyílás létesítése a fókuszált alakaton, körbetekerése az alakzat kerületén, méretállítás</li>
				<li><span class="warning">To do: </span> Kitöltőszín, (.. felirat, falvastagság...), szoba objektum.</li>
			</ul>
		</div>
		<div><em>Rendszerüzenetek:</em> <span id="msgConsole"></span></div>

		<h2>Vászon</h2>
		<!-- Credit to https://www.w3schools.com/graphics/svg_feoffset.asp -->
		<svg id="svgRoot" width="600" height="400">
			<defs>
				<filter id="shadow" x="-0.2" y="-0.2" width="200%" height="200%">
					<feOffset result="offOut" in="SourceGraphic" dx="8" dy="8" />
					<feColorMatrix result="matrixOut" in="offOut" type="matrix" values="0.2 0 0 0 0 0 0.2 0 0 0 0 0 0.2 0 0 0 0 0 1 0" />
					<feGaussianBlur result="blurOut" in="matrixOut" stdDeviation="3" />
					<feBlend in="SourceGraphic" in2="blurOut" mode="normal" />
				</filter>
			</defs>
		</svg>
	</body>
</html>
